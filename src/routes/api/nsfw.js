import r from"express";import e from"axios";const t=r.Router();t.get("/:tag",(async(r,t)=>{const{"tag":a}=r.params;try{const r=await async function(r){try{return(await e.get(`https://api.waifu.im/search?included_tags=${r}`)).data.images[0].url}catch(e){throw console.error(`Error fetching image URL for tag ${r}:`,e),new Error("Failed to fetch image URL")}}(a);t.writeHead(200,{"Content-Type":"image/jpeg"}),(await e.get(r,{"responseType":"stream"})).data.pipe(t)}catch(r){console.error(`Error processing request for tag ${a}:`,r.message),t.status(500).json({"error":"Internal Server Error","message":"An error occurred while processing the request."})}}));export default t;